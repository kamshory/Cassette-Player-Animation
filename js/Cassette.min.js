class Cassette{constructor(t,i,s,e,n){n=n||!1,this.index=0,this.reversed=n,this.song=t,this.duration=i,this.maxDuration=s,this.sources=e,this.pos=0,this.tapeLength=15*i/4,this.tapeThickness=26e-5,this.reelRadius=1.4,this.cover=!0,this.reel1=new Rheel(1,this.duration,this.maxDuration,this.tapeLength,this.tapeThickness,this.reelRadius,this.reversed),this.reel2=new Rheel(2,this.duration,this.maxDuration,this.tapeLength,this.tapeThickness,this.reelRadius,this.reversed),this.playing=!1,this.lastTime=new Date().getTime(),this.timeInterval=setInterval(function(){},1e5),this.getSongIndex=function(t){for(let i=0;i<o.sources.length;i++)if(o.sources[i].start<=t&&o.sources[i].end>=t)return i;return 0},this.setDuration=function(t){this.duration=t,this.reel1.setDuration(t),this.reel2.setDuration(t)},this.setMaxDuration=function(t){this.maxDuration=t,this.reel1.setDuration(t),this.reel2.setDuration(t)},this.play=function(){if(this.fastForwardOff(),this.lastTime=new Date().getTime(),this.playing=!0,this.song.duration>0){let t=this.getPosition();this.song.currentTime=t,this.song.play(),this.onPlay(t)}},this.onPlay=function(t){},this.onPause=function(t){},this.onFoundSong=function(t){},this.pause=function(){this.fastForwardOff(),this.playing=!1,this.song.pause();let t=this.getPosition();this.onPause(t)},this.getDeltaTime=function(){let t=new Date().getTime(),i=(t-this.lastTime)/1e3;return this.lastTime=t,i},this.getSongPosition=function(){return this.song.currentTime+0},this.setPosition=function(t){this.pos=t},this.getPosition=function(){return this.pos},this.updatePosition=function(t){this.pos+=t},this.rewindOn=function(){clearInterval(o.timeInterval),o.timeInterval=setInterval(function(){o.updatePosition(-1),o.song.currentTime=o.getPosition(),o.pos<=0&&clearInterval(o.timeInterval)},10)},this.rewindOff=function(){clearInterval(this.timeInterval)},this.fastForwardOn=function(){clearInterval(o.timeInterval),o.timeInterval=setInterval(function(){o.updatePosition(1),o.song.currentTime=o.getPosition(),o.getPosition()>=o.duration&&clearInterval(o.timeInterval)},10)},this.scan=function(){clearInterval(o.timeInterval),o.timeInterval=setInterval(function(){o.updatePosition(1);let t=o.getPosition();o.song.currentTime=t;let i=o.getSongIndex(t);i!=o.index&&(clearInterval(o.timeInterval),o.onFoundSong(i)),o.index=i},10)},this.fastForwardOff=function(){clearInterval(this.timeInterval)},this.openCover=function(){this.cover=!1},this.closeCover=function(){this.cover=!0};let o=this}}